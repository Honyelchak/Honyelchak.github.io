# 次小生成树

>  定义：给一个带权的图，把图的所有生成树俺权值从小到大排序，第二小的称为次小生成树。

### 分类

按照权值是否严格大于最小生成树又分为：

- 不严格次小生成树
- 严格次小生成树



### 方法一：

先求最小生成树，在枚举删去最小生成树中的边求解。时间复杂度为O(mlogm + nm)

不能求严格次小生成树。

### 方法二：

先求最小生成树，然后依次枚举非树边，然后将该边加入树中，同时从树中去掉一条边，使得最终的图仍是一颗生成树。则一定可以求出次小生成树。



设T为图G的一棵生成树，对于非树边a和树边b，插入边a，并删除边b的操作记为(+a, -b)。如果T + a - b 之后，仍然时一颗生成树，称(+a,-b)是T的一个可行交换。称由T进行一次可行变换所得到的新的生成树集合称为T的邻集。

**定理：**次小生成树一定在最小生成树的邻集中。





1. 求最小生成树，统计标记每条边是树边，还是非树边；同时把最小生成树建立出来。
2. 预处理任意两点间的边权最大值`dist[a][b]`
3. 依次枚举所有非树边，求`min(sum + w - dist[a][b])`,满足`w > dist[a][b]`

